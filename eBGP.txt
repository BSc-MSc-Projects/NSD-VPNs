R2  (R4)
conf t
interface FastEthernet0/0
 ip address 10.0.0.1 255.255.255.0
 no shutdown
!
interface FastEthernet1/0
 ip address 1.0.96.1 255.255.255.252
 no shutdown
!
interface Loopback0
 ip address 1.0.0.1 255.0.0.0
!
ip route 1.0.64.0 255.255.224.0 1.0.96.2
ip route 1.0.96.4 255.255.255.252 1.0.96.2
ip route 1.0.96.8 255.255.255.252 1.0.96.2
ip route 1.0.0.0 255.255.128.0 null0



router bgp 100

 neighbor 1.0.96.2 remote-as 100
 neighbor 1.0.96.2 next-hop-self 
 neighbor 1.0.96.2 route-map comm in
 
 neighbor ixp-peer peer-group
 neighbor ixp-peer send-community
 neighbor ixp-peer route-map set-local-pref in
 neighbor ixp-peer route-map comm out
 neighbor 10.0.0.2 remote-as 200
 neighbor 10.0.0.2 peer-group ixp-peer
 neighbor 10.0.0.2 prefix-list pl-peer200 in
 neighbor 10.0.0.3 remote-as 300
 neighbor 10.0.0.3 peer-group ixp-peer
 neighbor 10.0.0.3 prefix-list pl-peer300 in
 
 
 ip prefix-list pl-peer200 seq 5 permit 2.0.0.0/8
 ip prefix-list pl-peer300 seq 5 permit 3.0.0.0/8

route-map comm permit 10
 match community 10 11
 
route-map set-local-pref permit 10 
 set local-preference 150
 
ip bgp-community new-format
ip community-list 10 permit 100:1000
 
 
 
R3 (R7)
conf t
interface FastEthernet0/0
 ip address 10.0.0.2 255.255.255.0
 no shutdown
!

interface Loopback0
 ip address 2.0.0.1 255.0.0.0
!


router bgp 200
 network 2.0.0.0 mask 255.0.0.0
 neighbor 10.0.0.1 remote-as 100



R4 (R8?)
conf t
interface FastEthernet0/0
 ip address 10.0.0.3 255.255.255.0
 no shutdown
!
interface Loopback0
 ip address 3.0.0.1 255.0.0.0
!


router bgp 300
 network 3.0.0.0 mask 255.0.0.0
 neighbor 10.0.0.1 remote-as 100
 
 
 
R5 (R3)
interface Loopback0
 ip address 1.0.64.1 255.255.224.0
!
interface FastEthernet0/0
 ip address 1.0.96.2 255.255.255.252
 no shutdown
!
interface FastEthernet1/0
 ip address 1.0.96.5 255.255.255.252
 no shutdown
!
interface FastEthernet2/0
 ip address 1.0.96.9 255.255.255.252
 no shutdown
!
ip route 1.0.0.0 255.255.192.0 1.0.96.1
ip route 1.0.0.0 255.255.128.0 null0


router bgp 100
 network 1.0.0.0 mask 255.0.0.0 route-map comm
 neighbor 1.0.96.1 remote-as 100 
 neighbor 1.0.96.1 next-hop-self
 neighbor 1.0.96.1 send-community
 
route-map comm permit 10
 set community 100:1000




R6 (R2)
interface Loopback0
 ip address 1.0.128.1 255.255.255.0
!
interface FastEthernet0/0
 ip address 1.0.96.6 255.255.255.252
 no shutdown


R8 (Rbho)
interface Loopback0
 ip address 1.0.129.1 255.255.255.0
!
interface FastEthernet0/0
 ip address 1.0.96.10 255.255.255.252
 no shutdown

 
 

 
 